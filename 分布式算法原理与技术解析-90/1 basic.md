## 0 分布式知识体系

![下载](pic\分布式知识体系图.jpg)

业务架构（自底向上、横向）：资源、通信、数据、计算

> 在一定资源上，进行一定通信，通过一定计算，完成一定数据的加工和处理，从而对外提供特定的服务

技术栈（纵向）：分布式协同、分布式调度、分布式追踪与高可用、分布式部署



## 1 分布式起源

单机模式

- 性能受限、单点失效

<img src="pic\单机模式.png" alt="image-20210101192114970" style="zoom: 50%;" />

数据并行或数据分布式

- 并行计算强调的是对数据进行拆分，任务程序在每台机器上运行

<img src="pic\数据分布式.png" alt="image-20210101192158070" style="zoom:50%;" />

- 应用服务器上的任务就可以针对不同数据并行执行（每台计算机都是全量地从头到尾一条龙地执行一个程序，**对提升单个任务的执行性能及降低时延无效**）

  <img src="pic\数据分布式-2.png" alt="image-20210101192408007" style="zoom:50%;" />

  - 可以利用多台计算机并行处理多个请求
  - 优化方向
    - 负载均衡器
    - 数据库IO瓶颈—>读写分离、数据同步
    - 热点数据—>缓存



任务并行或任务分布式

<img src="D:\data\Indie Hacker\Indie Hacker\github\eat-rpc\eat-rpc\分布式算法原理与技术解析-90\pic\任务分布式.png" alt="image-20210101193453598" style="zoom:50%;" />

- 将单个复杂的任务拆分为多个子任务，从而使得多个子任务可以在不同的计算机上并行执行。
- 在提供了更好的性能、扩展性、可维护性的同时，也带来了设计上的复杂性



------

分布式：将相同或相关的程序运行在多台计算机上，从而实现特定目标的一种计算方式

> 数据并行、任务并行其实都可以算作是分布式的一种形态
>
> 驱动：对于性能、可用性及可扩展性的不懈追求



数据并行 or 任务并行 ？

- 数据并行：任务执行时间短，数据规模大、类型相同且无依赖
- 任务并行：任务复杂、执行时间长，且任务可拆分为多个子任务



分布式和传统并行计算的区别？

> 分布式的核心在于将任务拆解分布在不同的服务器上，业务解耦，提高性能和可用性（从数据、任务的并行上考虑，必须是不同物理机）
>
> 并行计算的核心在于充分利用服务器 cpu，内存，网络资源，将单个任务以多进程、多线程方式来运行（强调同时，可以是单台多核多处理器）

> 我的理解：分布式需要注重任务拆分，而传统的并行计算，例如并行计算框架，仅仅增加的机器



## 2 分布式系统的指标

分布式的目的：用更多的机器，处理更多的数据和更复杂的任务

**性能 Performance**

- 吞吐量（Throughput）：系统在一定时间内可以处理的任务数
  - QPS  查询数每秒（直接翻译为“秒”不准确，除此，改指标赢限制在一定响应时间下）
    - 某单核系统在99%分位200ms响应时间的要求下，系统最多能承受1000个查询，则QPS为1K, 而不是5。
  - TPS  事务数每秒
  - BPS  比特数每秒 （数据量）

- 响应时间
- 完成时间



**资源占用（Resource Usage）**

- CPU、内存、硬盘
- **空载资源占用**：系统在没有任何负载时的资源占用，体现了这个系统自身的资源占用情况
- **满载资源占用**：系统满额负载时的资源占用



**可用性（Availability）**

- 系统停止服务的时间与总的时间之比衡量

- 某请求失败次数与某请求总次数之比来衡量 （3N 5N—>99.999%）

  > **可靠性**：表示一个系统完全不出故障的概率
  >
  > **可用性**：允许部分组件失效的情况下，一个系统对外仍能正常提供服务的概率



**可伸缩性（Scalability）**

- 分布式系统通过扩展集群机器规模提高系统性能
- 当任务的需求随着具体业务不断提高时，除了优化系统的性能做垂直 / 纵向扩展外（CPU 增强、内存增大），另一个做法就是通过增加机器的方式去水平 / 横向扩展系统规模。
- 加速比（Speedup）：一个系统进行扩展后相对扩展前的性能提升
  - 拓展前后吞吐量之比
  - 拓展前后完成时间之比



不同场景下分布式系统的指标

- 电商：吞吐量
- IoT：资源占用指标
- 电信：响应时间、可用性
- HPC：拓展之后的加速比
- 大数据：拓展之后的加速比
- 云计算：响应时间、资源占用
- 区块链：吞吐量和完成时间

<img src="pic\不同业务系统对指标的要求.png" alt="image-20210101202251623" style="zoom:50%;" />

-----------

可伸缩性与可拓展性的区别？

> 可伸缩性（Scalability）：通过简单地增加硬件配置而使服务处理能力呈线性增长的能力